<?xml version="1.0" encoding="utf-8" ?>
<DataExchangeMaps>
  <!-- 
  *****
  ***  Import Mapping 
  *****
  -->
  <DataExchangeMap Name="" Identifier="ABR" Type="Import" FromDataSetIdentifier="Type1077" ToDataSetIdentifier="PM">
    <RecordMaps>

      <!-- ABR Tests -->
      <RecordMap Identifier="ABR" FromRecordDescriptionIdentifier="32972" ToRecordDescriptionIdentifier="ABR.TestInformation">
        <!-- Common Header -->
        <ColumnMapItem FromColumn="24581" ToColumn="Id"/>
        <ColumnMapItem FromColumn="24582" ToColumn="PatientId"/>
        <ColumnMapItem FromColumn="24583" ToColumn="UserAccountId"/>
        <ColumnMapItem FromColumn="24584" ToColumn="FirmwareVersion"/>

        <!-- Common Test Information -->
        <ColumnMapItem FromColumn="32769" ToColumn="Version"/>
        <ColumnMapItem FromColumn="32771" ToColumn="Ear"/>
        <ColumnMapItem FromColumn="32773" ToColumn="ProbeType"/>
        <ColumnMapItem FromColumn="32774" ToColumn="ProbeSerialNumber"/>
        <ColumnMapItem FromColumn="20496" ToColumn="ProbeCalibrationDate"/>
        <ColumnMapItem FromColumn="32775" ToColumn="TestTimeStamp"/>
        <ColumnMapItem FromColumn="32776" ToColumn="InstrumentSerialNumber"/>
        <ColumnMapItem FromColumn="32777" ToColumn="ProbeCounter"/>
        <ColumnMapItem FromColumn="32778" ToColumn="Duration"/>
        <ColumnMapItem FromColumn="32779" ToColumn="TestName"/>
        <ColumnMapItem FromColumn="32782" ToColumn="LocationId"/>
        <ColumnMapItem FromColumn="32783" ToColumn="FacilityId"/>

        <!-- Details -->
        <ColumnMapItem FromColumn="33281" ToColumn="TestResult"/>
        <ColumnMapItem FromColumn="33282" ToColumn="Version"/>
        <ColumnMapItem FromColumn="33283" ToColumn="Progress"/>
        <ColumnMapItem FromColumn="33284" ToColumn="Eeg"/>
        <ColumnMapItem FromColumn="33285" ToColumn="Abr"/>
        <ColumnMapItem FromColumn="33286" ToColumn="GraphScale"/>
        <ColumnMapItem FromColumn="33287" ToColumn="Graph"/>
        <ColumnMapItem FromColumn="33288" ToColumn="Frames"/>
        <ColumnMapItem FromColumn="33289" ToColumn="Energy"/>
        <ColumnMapItem FromColumn="33295" ToColumn="Impedances"/>
        <ColumnMapItem FromColumn="33296" ToColumn="NotchAmplifier"/>
        <ColumnMapItem FromColumn="33297" ToColumn="VariableNotchFrequency"/>
        <ColumnMapItem FromColumn="33298" ToColumn="SimulusLevel"/>

        <ColumnMapItem FromColumn="33290" ToColumn="CalibrationFrames"/>
        <ColumnMapItem FromColumn="33291" ToColumn="CalibrationValues"/>
        <ColumnMapItem FromColumn="33292" ToColumn="CalibrationGraphScale"/>
        <ColumnMapItem FromColumn="33293" ToColumn="CalibrationGraph"/>
        <ColumnMapItem FromColumn="33294" ToColumn="FrequencySamplingRate"/>
      </RecordMap>
    </RecordMaps>  
  </DataExchangeMap>
  
  <!-- 
  *****
  ***  Export Mapping 
  *****
  -->
  <DataExchangeMap Name="ABR Screening" Identifier="ABR" Type="Export" FromDataSetIdentifier="PM" ToDataSetIdentifier="Type1077">

    <RecordMaps>

      <!-- ABR Configurations -->
      <RecordMap Identifier="AbrPreset" FromRecordDescriptionIdentifier="AbrPreset" ToRecordDescriptionIdentifier="32975">
        <!-- Common Header -->
        <LiteralMapItem FromValue="32975" ToColumn="24577"/>
        <ColumnMapItem FromColumn="Id" ToColumn="24581"/>

        <!-- Specific Data -->
        <ColumnMapItem FromColumn="Name" ToColumn="33522"/>
        <ColumnMapItem FromColumn="Category" ToColumn="33521"/>
        <ColumnMapItem FromColumn="Level" ToColumn="33441">
          <ValueMapping Name="Db30">
            <Source>0</Source>
            <Destination>30</Destination>
          </ValueMapping>
          <ValueMapping Name="Db35">
            <Source>1</Source>
            <Destination>35</Destination>
          </ValueMapping>
          <ValueMapping Name="Db40">
            <Source>2</Source>
            <Destination>40</Destination>
          </ValueMapping>
          <ValueMapping Name="Db45">
            <Source>3</Source>
            <Destination>45</Destination>
          </ValueMapping>
        </ColumnMapItem>
      </RecordMap>

    </RecordMaps>

  </DataExchangeMap>
</DataExchangeMaps>